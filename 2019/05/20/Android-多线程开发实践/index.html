<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="brokge"><title>Android 多线程开发实践 · 吾與爾</title><meta name="description" content="#&amp;#x7279;&amp;#x70B9;&amp;#xFF1A;
&amp;#x5E76;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#x4EFB;&amp;#x52A1;&amp;#x3002;
&amp;#x5B58;&amp;#x5728; &amp;#x7EBF;&amp;#x7A0B;&amp;#x6570;&amp;#x636E;&amp;#x5B89;&amp;#x5168;&amp;#"><meta name="keywords" content="吾与尔"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style-red.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><link rel="stylesheet" href="/css/prism-ghcolors.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="stage" class="container"><div class="row"><div id="side-bar" class="col-sm-3 col-xs-12 side-container invisible"><div class="vertical-text site-title"><h3 tabindex="-1" class="site-title-small"><a href="/" class="a-title">I and i</a></h3><h1 tabindex="-1" class="site-title-large"><a href="/" class="a-title">吾與爾</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div id="site-nav" class="site-title-links"><ul><li><a href="/">首頁</a></li><li><a href="/archives">歸檔</a></li><li><a href="/categories">分類</a></li><li><a href="/tags">標籤</a></li><li> <a href="https://brokge.github.io/scrapydoc/">爬虫</a></li><li> <a href="https://brokge.github.io/linux-command-line/html/">Linux命令行</a></li><li><a href="/about/index.html">关于</a></li><li class="soc"><a href="https://github.com/brokge" target="_blank" rel="noopener noreferrer"><i class="fa fa-github">&nbsp;</i></a><a href="https://brokge.github.io/atom.xml" target="_blank" rel="noopener noreferrer"><i class="fa fa-rss">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2019&nbsp;<a target="_blank" href="https://brokge.github.io" rel="noopener noreferrer">brokge</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer><script type="text/javascript" id="maid-script" src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js?v=undefined"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize(options);
}
 </script></div></div></div><div id="main-container" class="col-sm-9 col-xs-12 main-container invisible"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a>Android 多线程开发实践</a></p><p class="post-meta"><span class="date meta-item">發佈於&nbsp;2019-05-20</span><span class="meta-item"><i class="fa fa-folder"></i><span>&nbsp;</span><a href="/categories/Android/" title="Android" class="a-tag">Android</a><span>&nbsp;</span></span><span class="meta-item"><i class="fa fa-tag"></i><span>&nbsp;</span><a href="/tags/Android/" title="Android" class="a-tag">Android</a><span>&nbsp;</span></span></p><p class="post-abstract"></p><h3><a href="#te-dian" class="header-anchor">#</a><span id="te-dian">&#x7279;&#x70B9;&#xFF1A;</span></h3><ol>
<li>&#x5E76;&#x884C;&#x5904;&#x7406;&#x4EFB;&#x52A1;&#x3002;</li>
<li>&#x5B58;&#x5728; &#x7EBF;&#x7A0B;&#x6570;&#x636E;&#x5B89;&#x5168;&#x3001;&#x6B7B;&#x9501;&#x3001;&#x5185;&#x5B58;&#x6D88;&#x8017;&#x3001;&#x5BF9;&#x8C61;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x7BA1;&#x7406;&#x3001;ui &#x7684;&#x5361;&#x987F; &#x7B49;&#x7B49;&#x3002;</li>
<li>&#x5B58;&#x5728;&#x4F18;&#x5148;&#x7EA7;&#x3002;</li>
</ol>
<h3><a href="#xian-cheng-you-xian-ji" class="header-anchor">#</a><span id="xian-cheng-you-xian-ji">&#x7EBF;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;</span></h3><p>&#x7EBF;&#x7A0B;&#x5BC4;&#x5BBF;&#x5728;&#x8FDB;&#x7A0B;&#x5F53;&#x4E2D;&#xFF0C;&#x7EBF;&#x7A0B;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x76F4;&#x63A5;&#x88AB;&#x8FDB;&#x7A0B;&#x6240;&#x5F71;&#x54CD;&#xFF0C;&#x800C;&#x8FDB;&#x7A0B;&#x7684;&#x5B58;&#x6D3B;&#x53C8;&#x548C;&#x5176;&#x4F18;&#x5148;&#x7EA7;&#x76F4;&#x63A5;&#x76F8;&#x5173;&#x3002;&#x5728;&#x5904;&#x7406;&#x8FDB;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5927;&#x90E8;&#x5206;&#x4EBA;&#x9760;&#x76F4;&#x89C9;&#x90FD;&#x80FD;&#x77E5;&#x9053;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#xFF08;<code>Foreground Process</code>&#xFF09;&#x4F18;&#x5148;&#x7EA7;&#x8981;&#x9AD8;&#x4E8E;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#xFF08;<code>Background Process</code>&#xFF09;&#x3002;&#x4F46;&#x8FD9;&#x79CD;&#x7C97;&#x7CD9;&#x7684;&#x5212;&#x5206;&#x65E0;&#x6CD5;&#x6EE1;&#x8DB3;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x9AD8;&#x7CBE;&#x5EA6;&#x8C03;&#x5EA6;&#x7684;&#x9700;&#x6C42;&#x3002;&#x65E0;&#x8BBA; Android &#x8FD8;&#x662F; iOS&#xFF0C;&#x7CFB;&#x7EDF;&#x5BF9;&#x4E8E; Foreground&#xFF0C;Background &#x8FDB;&#x7A0B;&#x6709;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x7EC6;&#x5316;&#x3002;</p>
<ol>
<li>Foreground Process</li>
</ol>
<p>Foreground&#x4E00;&#x822C;&#x610F;&#x5473;&#x7740;&#x7528;&#x6237;&#x53CC;&#x773C;&#x53EF;&#x89C1;&#xFF0C;&#x53EF;&#x89C1;&#x5374;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;active&#x3002;&#x5728;Android&#x7684;&#x4E16;&#x754C;&#x91CC;&#xFF0C;&#x4E00;&#x4E2A;Activity&#x5904;&#x4E8E;&#x524D;&#x53F0;&#x4E4B;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x80FD;&#x91C7;&#x96C6;&#x7528;&#x6237;&#x7684;input&#x4E8B;&#x4EF6;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5224;&#x5B9A;&#x4E3A;active&#xFF0C;&#x5982;&#x679C;&#x4E2D;&#x9014;&#x5F39;&#x51FA;&#x4E00;&#x4E2A;Dialog&#xFF0C;Dialog&#x53D8;&#x6210;&#x65B0;&#x7684;active&#x5B9E;&#x4F53;&#xFF0C;&#x76F4;&#x63A5;&#x9762;&#x5BF9;&#x7528;&#x6237;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x88AB;&#x90E8;&#x5206;&#x906E;&#x6321;&#x7684;activity&#x5C3D;&#x7BA1;&#x4F9D;&#x7136;&#x53EF;&#x89C1;&#xFF0C;&#x4F46;&#x72B6;&#x6001;&#x5374;&#x53D8;&#x4E3A;inactive&#x3002;&#x4E0D;&#x80FD;&#x6B63;&#x786E;&#x7684;&#x533A;&#x5206;visible&#x548C;active</p>
<ol start="2">
<li>Background Process</li>
</ol>
<p>&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x540C;&#x6837;&#x6709;&#x66F4;&#x7EC6;&#x7684;&#x5212;&#x5206;&#x3002;&#x6240;&#x8C13;&#x7684;Background&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x4E0D;&#x53EF;&#x89C1;&#xFF08;invisible&#xFF09;&#x3002;&#x5BF9;&#x4E8E;&#x4E0D;&#x53EF;&#x89C1;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;Android&#x4E5F;&#x6709;&#x91CD;&#x8981;&#x6027;&#x7684;&#x533A;&#x5206;&#x3002;&#x91CD;&#x8981;&#x7684;&#x540E;&#x53F0;&#x4EFB;&#x52A1;&#x5B9A;&#x4E49;&#x4E3A;Service&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5305;&#x542B;Service&#xFF08;&#x79F0;&#x4E3A;Service Process&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x201C;&#x91CD;&#x8981;&#x6027;&#x201D;&#x4E0A;&#x5C31;&#x4F1A;&#x88AB;&#x7CFB;&#x7EDF;&#x533A;&#x522B;&#x5BF9;&#x5F85;&#xFF0C;&#x5176;&#x4F18;&#x5148;&#x7EA7;&#x81EA;&#x7136;&#x4F1A;&#x9AD8;&#x4E8E;&#x4E0D;&#x5305;&#x542B;Service&#x7684;&#x8FDB;&#x7A0B;&#xFF08;&#x79F0;&#x4E3A;Background Process&#xFF09;&#xFF0C;&#x6700;&#x540E;&#x8FD8;&#x5269;&#x4E00;&#x7C7B;&#x7A7A;&#x8FDB;&#x7A0B;&#xFF08;Empty Process&#xFF09;&#x3002;Empty Process&#x521D;&#x770B;&#x6709;&#x4E9B;&#x8D39;&#x89E3;&#xFF0C;&#x4E00;&#x4E2A;Process&#x5982;&#x679C;&#x4EC0;&#x4E48;&#x90FD;&#x4E0D;&#x505A;&#xFF0C;&#x8FD8;&#x6709;&#x4EC0;&#x4E48;&#x5B58;&#x5728;&#x7684;&#x5FC5;&#x8981;&#x3002;&#x5176;&#x5B9E;Empty Process&#x5E76;&#x4E0D;Empty&#xFF0C;&#x8FD8;&#x5B58;&#x5728;&#x4E0D;&#x5C11;&#x7684;&#x5185;&#x5B58;&#x5360;&#x7528;&#x3002;</p>
<p>&#x5728;iOS&#x7684;&#x4E16;&#x754C;&#x91CC;&#xFF0C;Memory&#x88AB;&#x5206;&#x4E3A;Clean Memory&#x548C;Dirty Memory&#xFF0C;Clean Memory&#x662F;App&#x542F;&#x52A8;&#x88AB;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#x4E4B;&#x540E;&#x539F;&#x59CB;&#x5360;&#x7528;&#x7684;&#x90A3;&#x4E00;&#x90E8;&#x5206;&#x5185;&#x5B58;&#xFF0C;&#x4E00;&#x822C;&#x5305;&#x62EC;&#x521D;&#x59CB;&#x7684;stack, heap, text, data&#x7B49;segment&#xFF0C;Dirty Memory&#x662F;&#x7531;&#x4E8E;&#x7528;&#x6237;&#x64CD;&#x4F5C;&#x6240;&#x6539;&#x53D8;&#x7684;&#x90A3;&#x90E8;&#x5206;&#x5185;&#x5B58;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;App&#x7684;&#x72B6;&#x6001;&#x503C;&#x3002;&#x7CFB;&#x7EDF;&#x5728;&#x51FA;&#x73B0;Low Memory Warning&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x9996;&#x5148;&#x6E05;&#x6389;Dirty Memory&#xFF0C;&#x5BF9;&#x4E8E;&#x7528;&#x6237;&#x6765;&#x8BF4;&#xFF0C;&#x64CD;&#x4F5C;&#x7684;&#x8FDB;&#x5EA6;&#x5C31;&#x5168;&#x90E8;&#x4E22;&#x5931;&#x4E86;&#xFF0C;&#x5373;&#x4F7F;&#x518D;&#x6B21;&#x70B9;&#x51FB;App&#x56FE;&#x6807;&#xFF0C;&#x4E5F;&#x662F;&#x4E00;&#x5207;&#x4ECE;&#x5934;&#x5F00;&#x59CB;&#x3002;&#x4F46;&#x7531;&#x4E8E;Clean Memory&#x6CA1;&#x6709;&#x88AB;&#x6E05;&#x9664;&#xFF0C;&#x907F;&#x514D;&#x4E86;&#x4ECE;&#x78C1;&#x76D8;&#x91CD;&#x65B0;&#x8BFB;&#x53D6;app&#x6570;&#x636E;&#x7684;io&#x635F;&#x8017;&#xFF0C;&#x542F;&#x52A8;&#x4F1A;&#x53D8;&#x5FEB;&#x3002;&#x8FD9;&#x4E5F;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x5F88;&#x591A;&#x4EBA;&#x4F1A;&#x611F;&#x89C9;&#x624B;&#x673A;&#x91CD;&#x542F;&#x540E;&#xFF0C;app&#x6253;&#x5F00;&#x7684;&#x901F;&#x5EA6;&#x90FD;&#x6BD4;&#x8F83;&#x6162;&#x3002;</p>
<p>&#x540C;&#x7406;Android&#x4E16;&#x754C;&#x5F53;&#x4E2D;&#x7684;Empty Process&#x8FD8;&#x4FDD;&#x5B58;&#x6709;App&#x76F8;&#x5173;&#x7684;Clean Memory&#xFF0C;&#x8FD9;&#x90E8;&#x5206;Memory&#x5BF9;&#x4E8E;&#x63D0;&#x5347;App&#x7684;&#x542F;&#x52A8;&#x901F;&#x5EA6;&#x5927;&#x6709;&#x5E2E;&#x52A9;&#x3002;&#x663E;&#x800C;&#x6613;&#x89C1;Empty Process&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x662F;&#x6700;&#x4F4E;&#x7684;&#x3002;</p>
<table>
<thead>
<tr>
<th>&#x7EBF;&#x7A0B;&#x72B6;&#x6001;</th>
<th>&#x4F18;&#x5148;&#x7EA7;</th>
</tr>
</thead>
<tbody>
<tr>
<td>Active</td>
<td>Top</td>
</tr>
<tr>
<td>Visible</td>
<td>High</td>
</tr>
<tr>
<td>Service</td>
<td>High</td>
</tr>
<tr>
<td>Background</td>
<td>Low</td>
</tr>
<tr>
<td>Empty</td>
<td>Low</td>
</tr>
</tbody>
</table>
<p>Android&#x5C06;&#x7EBF;&#x7A0B;&#x5206;&#x4E3A;&#x591A;&#x4E2A;group&#xFF0C;&#x5176;&#x4E2D;&#x4E24;&#x7C7B;group&#x5C24;&#x5176;&#x91CD;&#x8981;&#x3002;&#x4E00;&#x7C7B;&#x662F;default group&#xFF0C;UI&#x7EBF;&#x7A0B;&#x5C5E;&#x4E8E;&#x8FD9;&#x4E00;&#x7C7B;&#x3002;&#x53E6;&#x4E00;&#x7C7B;&#x662F;background group&#xFF0C;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x5E94;&#x8BE5;&#x5F52;&#x5C5E;&#x5230;&#x8FD9;&#x4E00;&#x7C7B;&#x3002;background group&#x5F53;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x7EBF;&#x7A0B;&#x52A0;&#x8D77;&#x6765;&#x603B;&#x5171;&#x4E5F;&#x53EA;&#x80FD;&#x5206;&#x914D;&#x5230;5&#xFF5E;10%&#x7684;time slice&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x5168;&#x90E8;&#x5206;&#x914D;&#x7ED9;default group&#xFF0C;&#x8FD9;&#x6837;&#x8BBE;&#x8BA1;&#x663E;&#x7136;&#x80FD;&#x4FDD;&#x8BC1;UI&#x7EBF;&#x7A0B;&#x7ED8;&#x5236;UI&#x7684;&#x6D41;&#x7545;&#x6027;&#x3002;</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Process<span class="token punctuation">.</span><span class="token function">setThreadPriority</span><span class="token punctuation">(</span>Process<span class="token punctuation">.</span>THREAD_PRIORITY_BACKGROUND<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x6240;&#x4EE5;&#x5728;&#x6211;&#x4EEC;&#x51B3;&#x5B9A;&#x65B0;&#x542F;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x9996;&#x5148;&#x8981;&#x95EE;&#x81EA;&#x5DF1;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#x5728;&#x5B8C;&#x6210;&#x65F6;&#x95F4;&#x4E0A;&#x662F;&#x5426;&#x91CD;&#x8981;&#x5230;&#x8981;&#x548C;UI&#x7EBF;&#x7A0B;&#x4E89;&#x593A;CPU&#x8D44;&#x6E90;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x662F;&#xFF0C;&#x964D;&#x4F4E;&#x7EBF;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#x5C06;&#x5176;&#x5F52;&#x4E8E;background group&#xFF0C;&#x5982;&#x679C;&#x662F;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x8FDB;&#x4E00;&#x6B65;&#x7684;profile&#x770B;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x662F;&#x5426;&#x9020;&#x6210;UI&#x7EBF;&#x7A0B;&#x7684;&#x5361;&#x987F;&#x3002;</p>
<p>&#x867D;&#x8BF4;Android&#x7CFB;&#x7EDF;&#x5728;&#x4EFB;&#x52A1;&#x8C03;&#x5EA6;&#x4E0A;&#x662F;&#x4EE5;&#x7EBF;&#x7A0B;&#x4E3A;&#x57FA;&#x7840;&#x5355;&#x4F4D;&#xFF0C;&#x8BBE;&#x7F6E;&#x5355;&#x4E2A;thread&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x4E5F;&#x53EF;&#x4EE5;&#x6539;&#x53D8;&#x5176;&#x6240;&#x5C5E;&#x7684;control groups&#xFF0C;&#x4ECE;&#x800C;&#x5F71;&#x54CD;CPU time slice&#x7684;&#x5206;&#x914D;&#x3002;&#x4F46;&#x8FDB;&#x7A0B;&#x7684;&#x5C5E;&#x6027;&#x53D8;&#x5316;&#x4E5F;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x7EBF;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#xFF0C;&#x5F53;&#x4E00;&#x4E2A;App&#x8FDB;&#x5165;&#x540E;&#x53F0;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8BE5;App&#x6240;&#x5C5E;&#x7684;&#x6574;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x5C06;&#x8FDB;&#x5165;background group&#xFF0C;&#x4EE5;&#x786E;&#x4FDD;&#x5904;&#x4E8E;foreground&#xFF0C;&#x7528;&#x6237;&#x53EF;&#x89C1;&#x7684;&#x65B0;&#x8FDB;&#x7A0B;&#x80FD;&#x83B7;&#x53D6;&#x5230;&#x5C3D;&#x53EF;&#x80FD;&#x591A;&#x7684;CPU&#x8D44;&#x6E90;&#x3002;&#x7528;adb&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x4E0D;&#x540C;&#x8FDB;&#x7A0B;&#x7684;&#x5F53;&#x524D;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x3002;</p>
<pre class="line-numbers language-shell"><code class="language-shell">adb shell ps -P
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x5F53;&#x4F60;&#x7684;App&#x91CD;&#x65B0;&#x88AB;&#x7528;&#x6237;&#x5207;&#x6362;&#x5230;&#x524D;&#x53F0;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FDB;&#x7A0B;&#x5F53;&#x4E2D;&#x6240;&#x5C5E;&#x7684;&#x7EBF;&#x7A0B;&#x53C8;&#x4F1A;&#x56DE;&#x5F52;&#x7684;&#x539F;&#x6765;&#x7684;group&#x3002;&#x5728;&#x8FD9;&#x4E9B;&#x7528;&#x6237;&#x9891;&#x7E41;&#x5207;&#x6362;&#x7684;&#x8FC7;&#x7A0B;&#x5F53;&#x4E2D;&#xFF0C;thread&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x5E76;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#x53D8;&#x5316;&#xFF0C;&#x4F46;&#x7CFB;&#x7EDF;&#x5728;time slice&#x7684;&#x5206;&#x914D;&#x4E0A;&#x5374;&#x5728;&#x4E0D;&#x505C;&#x7684;&#x8C03;&#x6574;&#x3002;</p>
<h3><a href="#shi-fou-zhen-de-xu-yao-xin-xian-cheng" class="header-anchor">#</a><span id="shi-fou-zhen-de-xu-yao-xin-xian-cheng">&#x662F;&#x5426;&#x771F;&#x7684;&#x9700;&#x8981;&#x65B0;&#x7EBF;&#x7A0B;&#xFF1F;</span></h3><p>&#x5F00;&#x7EBF;&#x7A0B;&#x5E76;&#x4E0D;&#x662F;&#x63D0;&#x5347;App&#x6027;&#x80FD;&#xFF0C;&#x89E3;&#x51B3;UI&#x5361;&#x987F;&#x7684;&#x4E07;&#x91D1;&#x6CB9;&#x3002;&#x6BCF;&#x4E00;&#x4E2A;&#x65B0;&#x542F;&#x7684;&#x7EBF;&#x7A0B;&#x4F1A;&#x6D88;&#x8017;&#x81F3;&#x5C11;64KB&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x7CFB;&#x7EDF;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;switch context&#x4E5F;&#x4F1A;&#x5E26;&#x6765;&#x989D;&#x5916;&#x7684;&#x5F00;&#x9500;&#x3002;&#x5982;&#x679C;&#x968F;&#x610F;&#x5F00;&#x542F;&#x65B0;&#x7EBF;&#x7A0B;&#xFF0C;&#x968F;&#x7740;&#x4E1A;&#x52A1;&#x7684;&#x81A8;&#x80C0;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x5728;App&#x8FD0;&#x884C;&#x7684;&#x67D0;&#x4E2A;&#x65F6;&#x95F4;&#x70B9;&#x53D1;&#x73B0;&#x51E0;&#x5341;&#x4E2A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x5728;&#x8FD0;&#x884C;&#x3002;&#x540E;&#x679C;&#x662F;&#x539F;&#x672C;&#x60F3;&#x89E3;&#x51B3;UI&#x6D41;&#x7545;&#x6027;&#xFF0C;&#x5374;&#x53CD;&#x800C;&#x5BFC;&#x81F4;&#x4E86;&#x5076;&#x73B0;&#x7684;&#x4E0D;&#x53EF;&#x63A7;&#x7684;&#x5361;&#x987F;&#x3002;</p>
<p>&#x79FB;&#x52A8;&#x7AEF;App&#x65B0;&#x542F;&#x7EBF;&#x7A0B;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;UI&#x7684;&#x6D41;&#x7545;&#x6027;&#xFF0C;&#x589E;&#x52A0;App&#x7528;&#x6237;&#x64CD;&#x4F5C;&#x7684;&#x54CD;&#x5E94;&#x5EA6;&#x3002;&#x4F46;&#x662F;&#x5426;&#x9700;&#x8981;&#x5C06;&#x4EFB;&#x52A1;&#x653E;&#x5165;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x9700;&#x8981;&#x5148;&#x4E86;&#x89E3;&#x4EFB;&#x52A1;&#x7684;&#x74F6;&#x9888;&#x5728;&#x54EA;&#xFF0C;&#x662F;i/o&#xFF0C;gpu&#x8FD8;&#x662F;cpu&#xFF1F;UI&#x51FA;&#x73B0;&#x5361;&#x987F;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;UI&#x7EBF;&#x7A0B;&#x51FA;&#x73B0;&#x4E86;&#x8D39;&#x65F6;&#x7684;&#x8BA1;&#x7B97;&#xFF0C;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x5176;&#x5B83;&#x539F;&#x56E0;&#xFF0C;&#x6BD4;&#x5982;layout&#x5C42;&#x7EA7;&#x592A;&#x6DF1;&#x3002;</p>
<p>&#x5C3D;&#x91CF;&#x91CD;&#x7528;&#x5DF2;&#x6709;&#x7684;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#xFF08;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x6C60;&#xFF09;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x51FA;&#x73B0;&#x5927;&#x91CF;&#x540C;&#x65F6;&#x6D3B;&#x8DC3;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x6BD4;&#x5982;&#x5BF9;HTTP&#x8BF7;&#x6C42;&#x8BBE;&#x7F6E;&#x6700;&#x5927;&#x5E76;&#x53D1;&#x6570;&#x3002;&#x6216;&#x8005;&#x5C06;&#x4EFB;&#x52A1;&#x653E;&#x5165;&#x67D0;&#x4E2A;&#x4E32;&#x884C;&#x7684;&#x961F;&#x5217;&#xFF08;HandlerThread&#xFF09;&#x6309;&#x987A;&#x5E8F;&#x6267;&#x884C;&#xFF0C;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x4EFB;&#x52A1;&#x961F;&#x5217;&#x9002;&#x5408;&#x5904;&#x7406;&#x5927;&#x91CF;&#x8017;&#x65F6;&#x8F83;&#x77ED;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x907F;&#x514D;&#x51FA;&#x73B0;&#x5355;&#x4E2A;&#x4EFB;&#x52A1;&#x963B;&#x585E;&#x6574;&#x4E2A;&#x961F;&#x5217;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<p>&#x7528;&#x4EC0;&#x4E48;&#x59FF;&#x52BF;&#x5F00;&#x7EBF;&#x7A0B;&#xFF1F;</p>
<p>&#x5E38;&#x7528;&#x7684;&#x65B9;&#x5F0F;&#xFF1A;</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x4EC5;&#x4EC5;&#x662F;&#x8D77;&#x52A8;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x6CA1;&#x6709;&#x4EFB;&#x52A1;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x4E0D;&#x80FD;&#x505A;&#x72B6;&#x6001;&#x7684;&#x7BA1;&#x7406;&#x3002;start&#x4E4B;&#x540E;&#xFF0C;run&#x5F53;&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x5C31;&#x4E00;&#x5B9A;&#x4F1A;&#x6267;&#x884C;&#x5230;&#x5E95;&#xFF0C;&#x65E0;&#x6CD5;&#x4E2D;&#x9014;&#x53D6;&#x6D88;&#x3002;</p>
<p>==Runnable&#x4F5C;&#x4E3A;&#x533F;&#x540D;&#x5185;&#x90E8;&#x7C7B;&#x8FD8;&#x6301;&#x6709;&#x4E86;&#x5916;&#x90E8;&#x7C7B;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x5728;&#x7EBF;&#x7A0B;&#x9000;&#x51FA;&#x4E4B;&#x524D;&#xFF0C;&#x8BE5;&#x5F15;&#x7528;&#x4F1A;&#x4E00;&#x76F4;&#x5B58;&#x5728;&#xFF0C;&#x963B;&#x788D;&#x5916;&#x90E8;&#x7C7B;&#x5BF9;&#x8C61;&#x88AB;GC&#x56DE;&#x6536;&#xFF0C;&#x5728;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x5185;&#x9020;&#x6210;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;==&#x3002;</p>
<p>&#x6CA1;&#x6709;&#x7EBF;&#x7A0B;&#x5207;&#x6362;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x8981;&#x4F20;&#x9012;&#x5904;&#x7406;&#x7ED3;&#x679C;&#x5230;UI&#x7EBF;&#x7A0B;&#x7684;&#x8BDD;&#xFF0C;&#x9700;&#x8981;&#x5199;&#x989D;&#x5916;&#x7684;&#x7EBF;&#x7A0B;&#x5207;&#x6362;&#x4EE3;&#x7801;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4ECE;UI&#x7EBF;&#x7A0B;&#x542F;&#x52A8;&#xFF0C;&#x5219;&#x8BE5;&#x7EBF;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#x9ED8;&#x8BA4;&#x4E3A;Default&#xFF0C;&#x5F52;&#x4E8E;default cgroup&#xFF0C;&#x4F1A;&#x5E73;&#x7B49;&#x7684;&#x548C;UI&#x7EBF;&#x7A0B;&#x4E89;&#x593A;CPU&#x8D44;&#x6E90;&#x3002;&#x8FD9;&#x4E00;&#x70B9;&#x5C24;&#x5176;&#x9700;&#x8981;&#x6CE8;&#x610F;&#xFF0C;&#x5728;&#x5BF9;UI&#x6027;&#x80FD;&#x8981;&#x6C42;&#x9AD8;&#x7684;&#x573A;&#x666F;&#x4E0B;&#x8981;&#x8BB0;&#x5F97;</p>
<pre class="line-numbers language-java"><code class="language-java">Process<span class="token punctuation">.</span><span class="token function">setThreadPriority</span><span class="token punctuation">(</span>Process<span class="token punctuation">.</span>THREAD_PRIORITY_BACKGROUND<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x867D;&#x8BF4;&#x5904;&#x4E8E;background group&#x7684;&#x7EBF;&#x7A0B;&#x603B;&#x5171;&#x53EA;&#x80FD;&#x4E89;&#x53D6;&#x5230;5&#xFF5E;10%&#x7684;CPU&#x8D44;&#x6E90;&#xFF0C;&#x4F46;&#x8FD9;&#x5BF9;&#x7EDD;&#x5927;&#x90E8;&#x5206;&#x7684;&#x540E;&#x53F0;&#x4EFB;&#x52A1;&#x5904;&#x7406;&#x90FD;&#x7EF0;&#x7EF0;&#x6709;&#x4F59;&#x4E86;&#xFF0C;1ms&#x548C;10ms&#x5BF9;&#x7528;&#x6237;&#x6765;&#x8BF4;&#xFF0C;&#x90FD;&#x662F;&#x5FEB;&#x5230;&#x65E0;&#x6CD5;&#x611F;&#x77E5;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x4E00;&#x822C;&#x90FD;&#x504F;&#x5411;&#x4E8E;&#x5728;background group&#x5F53;&#x4E2D;&#x6267;&#x884C;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x4EFB;&#x52A1;&#x3002;</p>
<h3><a href="#asynctask" class="header-anchor">#</a><span id="asynctask">AsyncTask</span></h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAsyncTask</span> <span class="token keyword">extends</span> <span class="token class-name">AsyncTask</span> <span class="token punctuation">{</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> Object <span class="token function">doInBackground</span><span class="token punctuation">(</span>Object<span class="token punctuation">[</span><span class="token punctuation">]</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> null<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onPreExecute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onPreExecute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onPostExecute</span><span class="token punctuation">(</span>Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onPostExecute</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x548C;&#x4F7F;&#x7528;Thread()&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x591A;&#x4E86;&#x51E0;&#x5904;API&#x56DE;&#x8C03;&#x6765;&#x4E25;&#x683C;&#x89C4;&#x8303;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x4E0E;UI&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;&#x3002;&#x6211;&#x4EEC;&#x5927;&#x90E8;&#x5206;&#x7684;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x51E0;&#x4E4E;&#x90FD;&#x7B26;&#x5408;&#x8FD9;&#x79CD;&#x89C4;&#x8303;&#xFF0C;&#x6BD4;&#x5982;&#x53BB;&#x78C1;&#x76D8;&#x8BFB;&#x53D6;&#x56FE;&#x7247;&#xFF0C;&#x7F29;&#x653E;&#x5904;&#x7406;&#x9700;&#x8981;&#x5728;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#xFF0C;&#x6700;&#x540E;&#x7ED8;&#x5236;&#x5230;ImageView&#x63A7;&#x4EF6;&#x9700;&#x8981;&#x5207;&#x6362;&#x5230;UI&#x7EBF;&#x7A0B;&#x3002;</p>
<p>AsyncTask&#x7684;&#x51E0;&#x5904;&#x56DE;&#x8C03;&#x90FD;&#x7ED9;&#x4E86;&#x6211;&#x4EEC;&#x673A;&#x4F1A;&#x53BB;&#x4E2D;&#x65AD;&#x4EFB;&#x52A1;&#xFF0C;&#x5728;&#x4EFB;&#x52A1;&#x72B6;&#x6001;&#x7684;&#x7BA1;&#x7406;&#x4E0A;&#x8F83;&#x4E4B;Thread()&#x65B9;&#x5F0F;&#x66F4;&#x4E3A;&#x7075;&#x6D3B;&#x3002;&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x662F;AsyncTask&#x7684;cancel()&#x65B9;&#x6CD5;&#x5E76;&#x4E0D;&#x4F1A;&#x7EC8;&#x6B62;&#x4EFB;&#x52A1;&#x7684;&#x6267;&#x884C;&#xFF0C;&#x5F00;&#x53D1;&#x8005;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x53BB;&#x68C0;&#x67E5;cancel&#x7684;&#x72B6;&#x6001;&#x503C;&#x6765;&#x51B3;&#x5B9A;&#x662F;&#x5426;&#x4E2D;&#x6B62;&#x4EFB;&#x52A1;&#x3002;</p>
<p>==AsyncTask&#x4E5F;&#x6709;&#x9690;&#x5F0F;&#x7684;&#x6301;&#x6709;&#x5916;&#x90E8;&#x7C7B;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x9700;&#x8981;&#x7279;&#x522B;&#x6CE8;&#x610F;&#x9632;&#x6B62;&#x51FA;&#x73B0;&#x610F;&#x5916;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x3002;==</p>
<p>AsyncTask&#x7531;&#x4E8E;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x7CFB;&#x7EDF;&#x7248;&#x672C;&#x4E0A;&#x4E32;&#x884C;&#x4E0E;&#x5E76;&#x884C;&#x7684;&#x6267;&#x884C;&#x884C;&#x4E3A;&#x4E0D;&#x4E00;&#x81F4;&#xFF0C;&#x88AB;&#x4E0D;&#x5C11;&#x5F00;&#x53D1;&#x8005;&#x6240;&#x8BDF;&#x75C5;&#xFF0C;&#x8FD9;&#x786E;&#x5B9E;&#x662F;&#x786C;&#x4F24;&#xFF0C;&#x7EDD;&#x5927;&#x90E8;&#x5206;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x573A;&#x666F;&#x90FD;&#x9700;&#x8981;&#x660E;&#x786E;&#x4EFB;&#x52A1;&#x662F;&#x4E32;&#x884C;&#x8FD8;&#x662F;&#x5E76;&#x884C;&#x3002;</p>
<p>&#x7EBF;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#x4E3A;background&#xFF0C;&#x5BF9;UI&#x7EBF;&#x7A0B;&#x7684;&#x6267;&#x884C;&#x5F71;&#x54CD;&#x6781;&#x5C0F;&#x3002;</p>
<h3><a href="#handlerthread" class="header-anchor">#</a><span id="handlerthread">HandlerThread</span></h3><p>&#x5728;&#x9700;&#x8981;&#x5BF9;&#x591A;&#x4EFB;&#x52A1;&#x505A;&#x66F4;&#x7CBE;&#x7EC6;&#x63A7;&#x5236;&#xFF0C;&#x7EBF;&#x7A0B;&#x5207;&#x6362;&#x66F4;&#x9891;&#x7E41;&#x7684;&#x573A;&#x666F;&#x4E4B;&#x4E0B;&#xFF0C;Thread()&#x548C;AsyncTask&#x90FD;&#x4F1A;&#x663E;&#x5F97;&#x529B;&#x4E0D;&#x4ECE;&#x5FC3;&#x3002;HandlerThread&#x5374;&#x80FD;&#x80DC;&#x4EFB;&#x8FD9;&#x4E9B;&#x9700;&#x6C42;&#x751A;&#x81F3;&#x66F4;&#x591A;&#x3002;</p>
<p>HandlerThread&#x5C06;Handler&#xFF0C;Thread&#xFF0C;Looper&#xFF0C;MessageQueue&#x51E0;&#x4E2A;&#x6982;&#x5FF5;&#x76F8;&#x7ED3;&#x5408;&#x3002;Handler&#x662F;&#x7EBF;&#x7A0B;&#x5BF9;&#x5916;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x6240;&#x6709;&#x65B0;&#x7684;message&#x6216;&#x8005;runnable&#x90FD;&#x901A;&#x8FC7;handler post&#x5230;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x3002;Looper&#x5728;MessageQueue&#x53D6;&#x5230;&#x65B0;&#x7684;&#x4EFB;&#x52A1;&#x5C31;&#x5207;&#x6362;&#x5230;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x53BB;&#x6267;&#x884C;&#x3002;&#x4E0D;&#x540C;&#x7684;post&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x8BA9;&#x6211;&#x4EEC;&#x5BF9;&#x4EFB;&#x52A1;&#x505A;&#x7CBE;&#x7EC6;&#x7684;&#x63A7;&#x5236;&#xFF0C;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x6267;&#x884C;&#xFF0C;&#x6267;&#x884C;&#x7684;&#x987A;&#x5E8F;&#x90FD;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x3002;HandlerThread&#x6700;&#x5927;&#x7684;&#x4F18;&#x52BF;&#x5728;&#x4E8E;&#x5F15;&#x5165;MessageQueue&#x6982;&#x5FF5;&#xFF0C;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x591A;&#x4EFB;&#x52A1;&#x961F;&#x5217;&#x7BA1;&#x7406;&#x3002;</p>
<p>HandlerThread&#x80CC;&#x540E;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;&#x4EFB;&#x52A1;&#x662F;==&#x4E32;&#x884C;==&#x6267;&#x884C;&#x7684;&#x3002;&#x4E32;&#x884C;&#x76F8;&#x5BF9;&#x4E8E;&#x5E76;&#x884C;&#x6765;&#x8BF4;&#x66F4;&#x5B89;&#x5168;&#xFF0C;&#x5404;&#x4EFB;&#x52A1;&#x4E4B;&#x95F4;&#x4E0D;&#x4F1A;&#x5B58;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x3002;</p>
<p>==HandlerThread&#x6240;&#x4EA7;&#x751F;&#x7684;&#x7EBF;&#x7A0B;&#x4F1A;&#x4E00;&#x76F4;&#x5B58;&#x6D3B;==&#xFF0C;Looper&#x4F1A;&#x5728;&#x8BE5;&#x7EBF;&#x7A0B;&#x4E2D;&#x6301;&#x7EED;&#x7684;&#x68C0;&#x67E5;MessageQueue&#x3002;&#x8FD9;&#x4E00;&#x70B9;&#x548C;Thread()&#xFF0C;AsyncTask&#x90FD;&#x4E0D;&#x540C;&#xFF0C;thread&#x5B9E;&#x4F8B;&#x7684;&#x91CD;&#x7528;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x7EBF;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x9891;&#x7E41;&#x91CD;&#x5EFA;&#x548C;&#x9500;&#x6BC1;&#x3002;</p>
<p>HandlerThread&#x8F83;&#x4E4B;Thread()&#xFF0C;AsyncTask&#x9700;&#x8981;&#x5199;&#x66F4;&#x591A;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x4F46;&#x5728;&#x5B9E;&#x7528;&#x6027;&#xFF0C;&#x7075;&#x6D3B;&#x5EA6;&#xFF0C;&#x5B89;&#x5168;&#x6027;&#x4E0A;&#x90FD;&#x6709;&#x66F4;&#x597D;&#x7684;&#x8868;&#x73B0;&#x3002;</p>
<h3><a href="#threadpoolexecutor" class="header-anchor">#</a><span id="threadpoolexecutor">ThreadPoolExecutor</span></h3><p>Thread(),AsyncTask&#x9002;&#x5408;&#x5904;&#x7406;&#x5355;&#x4E2A;&#x4EFB;&#x52A1;&#x7684;&#x573A;&#x666F;&#xFF0C;HandlerThread&#x9002;&#x5408;&#x4E32;&#x884C;&#x5904;&#x7406;&#x591A;&#x4EFB;&#x52A1;&#x7684;&#x573A;&#x666F;&#x3002;&#x5F53;&#x9700;&#x8981;&#x5E76;&#x884C;&#x7684;&#x5904;&#x7406;&#x591A;&#x4EFB;&#x52A1;&#x4E4B;&#x65F6;&#xFF0C;ThreadPoolExecutor&#x662F;&#x66F4;&#x597D;&#x7684;&#x9009;&#x62E9;&#x3002;</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> Executor THREAD_POOL_EXECUTOR
            <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>CORE_POOL_SIZE<span class="token punctuation">,</span> MAXIMUM_POOL_SIZE<span class="token punctuation">,</span> KEEP_ALIVE<span class="token punctuation">,</span>
            TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span> sPoolWorkQueue<span class="token punctuation">,</span> sThreadFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x7EBF;&#x7A0B;&#x6C60;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x7EBF;&#x7A0B;&#x7684;&#x9891;&#x7E41;&#x521B;&#x5EFA;&#x548C;&#x9500;&#x6BC1;&#xFF0C;&#x663E;&#x7136;&#x6027;&#x80FD;&#x66F4;&#x597D;&#xFF0C;&#x4F46;&#x7EBF;&#x7A0B;&#x6C60;&#x5E76;&#x53D1;&#x7684;&#x7279;&#x6027;&#x5F80;&#x5F80;&#x4E5F;&#x662F;&#x7591;&#x96BE;&#x6742;&#x75C7;&#x7684;&#x6E90;&#x5934;&#xFF0C;&#x662F;&#x4EE3;&#x7801;&#x964D;&#x7EA7;&#x548C;&#x5931;&#x63A7;&#x7684;&#x5F00;&#x59CB;&#x3002;&#x591A;&#x7EBF;&#x7A0B;&#x5E76;&#x884C;&#x5BFC;&#x81F4;&#x7684;bug&#x5F80;&#x5F80;&#x662F;&#x5076;&#x73B0;&#x7684;&#xFF0C;&#x4E0D;&#x65B9;&#x4FBF;&#x8C03;&#x8BD5;&#xFF0C;&#x4E00;&#x65E6;&#x51FA;&#x73B0;&#x5C31;&#x4F1A;&#x8017;&#x6389;&#x5927;&#x91CF;&#x7684;&#x5F00;&#x53D1;&#x7CBE;&#x529B;&#x3002;</p>
<p>ThreadPool&#x8F83;&#x4E4B;HandlerThread&#x5728;&#x5904;&#x7406;&#x591A;&#x4EFB;&#x52A1;&#x4E0A;&#x6709;&#x66F4;&#x9AD8;&#x7684;&#x7075;&#x6D3B;&#x6027;&#xFF0C;&#x4F46;&#x4E5F;&#x5E26;&#x6765;&#x4E86;&#x66F4;&#x5927;&#x7684;&#x590D;&#x6742;&#x5EA6;&#x548C;&#x4E0D;&#x786E;&#x5B9A;&#x6027;&#x3002;</p>
<h3><a href="#intentservice" class="header-anchor">#</a><span id="intentservice">IntentService</span></h3><p>&#x4E0D;&#x5F97;&#x4E0D;&#x8BF4;Android&#x5728;API&#x8BBE;&#x8BA1;&#x4E0A;&#x7C92;&#x5EA6;&#x5F88;&#x7EC6;&#xFF0C;&#x540C;&#x4E00;&#x6837;&#x5DE5;&#x4F5C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5404;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x7C7B;&#x6765;&#x5B8C;&#x6210;&#x3002;IntentService&#x53C8;&#x662F;&#x53E6;&#x4E00;&#x79CD;&#x5F00;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x4ECE;&#x540D;&#x5B57;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x8FD9;&#x4E2A;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x4F1A;&#x5E26;&#x6709;service&#x7684;&#x5C5E;&#x6027;&#x3002;&#x548C;AsyncTask&#x4E0D;&#x540C;&#xFF0C;&#x6CA1;&#x6709;&#x548C;UI&#x7EBF;&#x7A0B;&#x7684;&#x4EA4;&#x4E92;&#xFF0C;&#x4E5F;&#x4E0D;&#x50CF;HandlerThread&#x7684;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x4F1A;&#x4E00;&#x76F4;&#x5B58;&#x6D3B;&#x3002;IntentService&#x80CC;&#x540E;&#x5176;&#x5B9E;&#x4E5F;&#x6709;&#x4E00;&#x4E2A;HandlerThread&#x6765;&#x4E32;&#x884C;&#x7684;&#x5904;&#x7406;Message Queue&#xFF0C;&#x4ECE;IntentService&#x7684;onCreate&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF1A;</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// TODO: It would be nice to have an option to hold a partial wakelock</span>
        <span class="token comment" spellcheck="true">// during processing, and to have a static startService(Context, Intent)</span>
        <span class="token comment" spellcheck="true">// method that would launch the service &amp; hand off a wakelock.</span>

        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        HandlerThread thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HandlerThread</span><span class="token punctuation">(</span><span class="token string">&quot;IntentService[&quot;</span> <span class="token operator">+</span> mName <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        mServiceLooper <span class="token operator">=</span> thread<span class="token punctuation">.</span><span class="token function">getLooper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mServiceHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServiceHandler</span><span class="token punctuation">(</span>mServiceLooper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x53EA;&#x4E0D;&#x8FC7;&#x5728;&#x6240;&#x6709;&#x7684;Message&#x5904;&#x7406;&#x5B8C;&#x6BD5;&#x4E4B;&#x540E;&#xFF0C;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x4F1A;&#x81EA;&#x52A8;&#x7ED3;&#x675F;&#x3002;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x628A;IntentService&#x770B;&#x505A;&#x662F;Service&#x548C;HandlerThread&#x7684;&#x7ED3;&#x5408;&#x4F53;&#xFF0C;&#x9002;&#x5408;&#x9700;&#x8981;&#x5728;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x5904;&#x7406;UI&#x65E0;&#x5173;&#x4EFB;&#x52A1;&#x7684;&#x573A;&#x666F;&#x3002;</p>
<h3><a href="#jie-shu-yu" class="header-anchor">#</a><span id="jie-shu-yu">&#x7ED3;&#x675F;&#x8BED;</span></h3><p>Android&#x5F00;&#x7EBF;&#x7A0B;&#x7684;&#x65B9;&#x5F0F;&#x867D;&#x7136;&#x4E94;&#x82B1;&#x516B;&#x95E8;&#xFF0C;&#x4F46;&#x5F52;&#x6839;&#x5230;&#x5E95;&#x6700;&#x540E;&#x8FD8;&#x662F;&#x6620;&#x5C04;&#x5230;linux&#x4E0B;&#x7684;pthread&#xFF0C;&#x4E1A;&#x52A1;&#x7684;&#x8BBE;&#x8BA1;&#x8FD8;&#x662F;&#x8131;&#x4E0D;&#x4E86;&#x548C;&#x7EBF;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x57FA;&#x7840;&#x6982;&#x5FF5;&#x8303;&#x7574;&#xFF1A;&#x7EBF;&#x7A0B;&#x7684;&#x6267;&#x884C;&#x987A;&#x5E8F;&#xFF0C;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#xFF0C;&#x751F;&#x547D;&#x5468;&#x671F;&#xFF0C;&#x4E32;&#x884C;&#x8FD8;&#x662F;&#x5E76;&#x884C;&#xFF0C;&#x540C;&#x6B65;&#x8FD8;&#x662F;&#x5F02;&#x6B65;&#x7B49;&#x7B49;&#x3002;&#x6478;&#x6E05;&#x695A;&#x5404;&#x7C7B;API&#x4E0B;&#x7EBF;&#x7A0B;&#x7684;&#x884C;&#x4E3A;&#x7279;&#x70B9;&#xFF0C;&#x5728;&#x8BBE;&#x8BA1;&#x5177;&#x4F53;&#x4E1A;&#x52A1;&#x7684;&#x7EBF;&#x7A0B;&#x6A21;&#x578B;&#x7684;&#x65F6;&#x5019;&#x81EA;&#x7136;&#x8F7B;&#x8F66;&#x719F;&#x8DEF;&#x4E86;&#xFF0C;&#x7EBF;&#x7A0B;&#x6A21;&#x578B;&#x7684;&#x8BBE;&#x8BA1;&#x8981;&#x6709;&#x6574;&#x4E2A;app&#x89C6;&#x89D2;&#x7684;&#x5E7F;&#x5EA6;&#xFF0C;&#x5207;&#x5FCC;&#x5404;&#x4E1A;&#x52A1;&#x6A21;&#x5757;&#x5404;&#x73A9;&#x5404;&#x7684;&#x3002;</p>
<p></p></div><div class="share"><span>分享到</span>&nbsp;<span class="soc"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></span><span class="soc"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></span><span class="soc"><a href="http://twitter.com/home?status=https://brokge.github.io/2019/05/20/Android-多线程开发实践/%20吾與爾%20Android 多线程开发实践" class="fa fa-twitter"></a></span></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/2019/06/30/Android-应用内存分析/" title="Android 应用内存分析"><i class="fa fa-angle-double-left"></i>&nbsp;上一篇: Android 应用内存分析</a></span><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/2019/04/16/Android-Dagger2分析/" title="Android Dagger2分析">下一篇: Android Dagger2分析&nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div><div id="vcomments"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script type="text/javascript">(function(){
    new Valine({
    el: '#vcomments',
    appId: 'UmwJ3stwyISCG9WnW9Nc3SAN-gzGzoHsz',
    appKey: 'UKq878kYn6RXJWx34b77lma6'})
})();
</script></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2019&nbsp;<a target="_blank" href="https://brokge.github.io" rel="noopener noreferrer">brokge</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer><script type="text/javascript" id="maid-script" src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js?v=undefined"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize(options);
}
 </script></div></div></div></div><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/google-analytics.js"></script><script src="/js/typography.js"></script></body></html>